<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Top 10 Food Importers to the U.S.</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
</head>
<body>
  <!-- Header -->
  <header>
    <h1>Top 10 Food Importers to the U.S.</h1>
    <p>This analysis looks at the top 10 importers of food to the U.S., but we're particularly interested in Canada's contribution. On this screen, it is clear 
    that Canada is the greatest importer to the U.S. compared to the other countries. Click on the buttons below to further look at what makes up Canada's contribution.
    <em></em>Hover to see each country's main commodity export and how much it contributes to the total.</em></p>
  </header>

  <div id="chart"></div>
  
 <button onclick="window.location.href='https://raw.githubusercontent.com/ryan-klein-ok/u_of_i_project/main/index.html'">Summary Chart</button>
  <button onclick="window.location.href='https://raw.githubusercontent.com/ryan-klein-ok/u_of_i_project/main/document2.html'">Canada's Top Commodities</button>
  <button onclick="window.location.href='https://raw.githubusercontent.com/ryan-klein-ok/u_of_i_project/main/document1.html'">Canada's Commodity by Year</button>

  <script>
    d3.csv("https://raw.githubusercontent.com/ryan-klein-ok/u_of_i_project/main/country.csv").then(function(data) {
      data.forEach(function(d) {
        d.country_total = +d.country_total;
      });

      data.sort(function(a, b) {
        return d3.descending(a.country_total, b.country_total);
      });

       const margin = { top: 40, right: 20, bottom: 120, left: 80 };
      const width = 800 - margin.left - margin.right;
      const height = 400 - margin.top - margin.bottom;

      const svg = d3.select("#chart")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      //  x-axis scale
      const x = d3.scaleBand()
        .domain(data.map(d => d.country))
        .range([0, width])
        .padding(0.1);

      // y-axis scale
      const y = d3.scaleLinear()
        .domain([0, d3.max(data, d => d.country_total)])
        .range([height, 0]);

      svg.selectAll(".bar")
        .data(data)
        .enter()
        .append("rect")
        .attr("class", "bar")
        .attr("x", d => x(d.country))
        .attr("y", d => y(d.country_total))
        .attr("width", x.bandwidth())
        .attr("height", d => height - y(d.country_total))
 .attr("fill", "#00ff00")
        .on("mouseover", function(event, d) {
          tooltip.html("<strong>Commodity:</strong> " + d.commodity + "<br><strong>Commodity Total:</strong> " + d.commodity_total)
            .style("visibility", "visible");
        })
        .on("mousemove", function(event) {
          tooltip.style("top", (event.pageY - 10) + "px")
            .style("left", (event.pageX + 10) + "px");
        })
        .on("mouseout", function() {
          tooltip.style("visibility", "hidden");
        });

      // Create x-axis
      svg.append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x))
        .selectAll("text")
        .style("text-anchor", "end")
        .attr("dx", "-.8em")
        .attr("dy", "-.55em")
        .attr("transform", "rotate(-90)");

      // Create y-axis
      svg.append("g").call(d3.axisLeft(y));

      // Create tooltip 
      const tooltip = d3.select("body")
        .append("div")
        .style("position", "absolute")
        .style("background-color", "white")
        .style("border", "1px solid #ddd")
        .style("padding", "8px")
        .style("font-size", "12px")
        .style("visibility", "hidden");

    }).catch(function(error) {
      console.log(error);
    });
  </script>
</body>
</html>

